<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="filePage.css">
  <script src="filePage.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <title>Files Page</title>
</head>

<body>
  <!--
<div class="topnav">
    <a class="navbar-brand" href="/" aria-label="Notelord"></a>
    <a href="Home.html">Home</a>
    <a class="active" href="Filepage.html">Files</a>
    <a href="Glossary.html">Glossary</a>
    <a href="Translate.html">Translate</a> 
  </div>
  -->
  <section>
    <input type="checkbox" id="check">
    <header>
      <h2>NOTELORD</h2>
      <div class="navigation">
        <a href="splashScreen.html">Home</a>
        <a href="User_Manual.html">Manual</a>
        <a href="translate.html">Translate</a>
      </div>
      <label for="check">
        <i class="fas fa-bars menu-btn"></i>
        <i class="fas fa-times close-btn"></i>
      </label>
    </header>
    <div class="content">
      <div class="info">

        <h2>Your files<br><span>Access your files</span></h2>
        <p>Open, new, and delete.</p>
        <a href="#" class="info-btn open">Open</a>
        <a href="translate.html" class="info-btn">New</a>
        <a href="#" class="info-btn search"> Search</a>
        <a href="#" class="info-btn delete">Delete</a>

        <!--
            <div class="box">
              <ul class="directory-list" id="fileList"> 
                <li class="folder">Your files
                  <ul id="fileListItems"> 
        </div>
            -->

      </div>


      </ul>
      </li>
      </ul>
    </div>
  </section>

  <script>
    // Function to open the pop-up window with the file list
    function openFileListWindow() {
      const popupUrl = 'file_List/fileList_open.html';
      const popupWidth = 536;
      const popupHeight = 204;
      const left = (window.innerWidth - popupWidth) / 2;
      const top = (window.innerHeight - popupHeight) / 2;
      const popupOptions = `width=${popupWidth},height=${popupHeight},left=${left},top=${top},resizable,scrollbars=yes`;
      window.open(popupUrl, '_blank', popupOptions);
    }

    // Add event listener to the "Open" button
    const openBtn = document.querySelector('.info-btn.open');
    openBtn.addEventListener('click', openFileListWindow);
  </script>

  <script>
    function deleteFileListWindow() {
      const popupUrl = 'file_List/fileList_search.html';
      const popupWidth = 536;
      const popupHeight = 204;
      const left = (window.innerWidth - popupWidth) / 2;
      const top = (window.innerHeight - popupHeight) / 2;
      const popupOptions = `width=${popupWidth},height=${popupHeight},left=${left},top=${top},resizable,scrollbars=yes`;
      window.open(popupUrl, '_blank', popupOptions);
    }
    // Add event listener to the "Delete" button
    const deleteBtn = document.querySelector('.info-btn.delete');
    deleteBtn.addEventListener('click', deleteFileListWindow);
  </script>

  <script>
    function searchFileListWindow() {
      const popupUrl = 'file_List/fileList_search.html';
      const popupWidth = 536;
      const popupHeight = 204;
      const left = (window.innerWidth - popupWidth) / 2;
      const top = (window.innerHeight - popupHeight) / 2;
      const popupOptions = `width=${popupWidth},height=${popupHeight},left=${left},top=${top},resizable,scrollbars=yes`;
      window.open(popupUrl, '_blank', popupOptions);
    }

    
    function search() {
      var fileListName = window.prompt('Search: ');
      fetch('http://localhost:3000/files')
        .then(response => response.json())
        .then(data => {
          const fileList = document.getElementById('fileListItems');
          if (data.length === 0) {
            const listItem = document.createElement('li');
            listItem.className = 'file';
            listItem.textContent = 'No existing file in the database. Please create a new one.';
            fileList.appendChild(listItem);
          } else {
            data.forEach(file => {
              const listItem = document.createElement('li');
              listItem.className = 'file';

              const link = document.createElement('a');
              link.textContent = file.filename;
              link.href = `../translate.html?fileName=${encodeURIComponent(file.filename)}`;

              link.addEventListener('click', (event) => {
                event.preventDefault(); // Prevents the default link navigation behavior
                window.close(); // Closes the pop-up window
                window.opener.location.href = link.href; // Opens translate.html in the original window
              });

              listItem.appendChild(link);
              fileList.appendChild(listItem);
            });
          }
        })
        .catch(error => {
          console.error('Error retrieving file list:', error);
        });
    }

    // Add event listener to the "Delete" button
    const searchBtn = document.querySelector('.info-btn.search');
    searchBtn.addEventListener('click', searchFileListWindow);

  </script>


</body>

</html>
